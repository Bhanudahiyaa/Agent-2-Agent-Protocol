import { Role as RoleEnum, A2AServer, DefaultA2ARequestHandler, OperationNotSupportedError } from '../../src/index.js';
/**
 * Hello World Agent implementation
 */
class HelloWorldAgent {
    async invoke() {
        return 'Hello World';
    }
    async *stream() {
        yield { content: 'Hello ', done: false };
        await new Promise(resolve => setTimeout(resolve, 2000));
        yield { content: 'World', done: false };
        await new Promise(resolve => setTimeout(resolve, 1000));
        yield { content: '!', done: true };
    }
}
class HelloWorldAgentExecutor {
    constructor() {
        this.agent = new HelloWorldAgent();
    }
    async onMessageSend(request, task) {
        const result = await this.agent.invoke();
        const message = {
            role: RoleEnum.Agent,
            parts: [{ type: 'text', text: result }]
        };
        return {
            jsonrpc: '2.0',
            id: request.id,
            result: message
        };
    }
    async *onMessageStream(request, task) {
        for await (const chunk of this.agent.stream()) {
            const message = {
                role: RoleEnum.Agent,
                parts: [{ type: 'text', text: chunk.content }]
            };
            yield {
                jsonrpc: '2.0',
                id: request.id,
                result: message
            };
        }
    }
    async onCancel(request, task) {
        return {
            jsonrpc: '2.0',
            id: request.id,
            error: new OperationNotSupportedError()
        };
    }
    async *onResubscribe(request, task) {
        yield {
            jsonrpc: '2.0',
            id: request.id,
            error: new OperationNotSupportedError()
        };
    }
}
const skill = {
    id: 'hello_world',
    name: 'Returns hello world',
    description: 'just returns hello world',
    tags: ['hello world'],
    examples: ['hi', 'hello world'],
};
const agentCard = {
    name: 'Hello World Agent',
    description: 'Just a hello world agent',
    url: 'http://localhost:9999/',
    version: '1.0.0',
    defaultInputModes: ['text'],
    defaultOutputModes: ['text'],
    capabilities: { streaming: true },
    skills: [skill],
    authentication: {
        schemes: ['public'],
    }
};
const requestHandler = new DefaultA2ARequestHandler(new HelloWorldAgentExecutor());
const port = process.env.PORT ? parseInt(process.env.PORT, 10) : 9999;
const server = new A2AServer(agentCard, requestHandler);
server.start({ port });
//# sourceMappingURL=server.js.map